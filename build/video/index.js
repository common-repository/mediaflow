(()=>{"use strict";const e=window.React,t=window.wp.components,n=window.wp.element,o=window.wp.blockEditor,i=(0,n.forwardRef)((function({icon:e,size:t=24,...o},i){return(0,n.cloneElement)(e,{width:t,height:t,...o,ref:i})})),l=window.wp.primitives,a=window.ReactJSXRuntime,c=(0,a.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,a.jsx)(l.Path,{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})}),s=window.wp.blocks,r=window.wp.i18n,d=JSON.parse('{"u2":"mediaflow/video","TN":"Mediaflow Video Embed"}'),w=async(e,t)=>{const{REST_API_URL:n,WP_NONCE:o}=window.mediaflow,i=`${n}${e}`;return await fetch(i,{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json","X-WP-Nonce":o}})};(0,s.registerBlockType)(d.u2,{icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},(0,e.createElement)("g",{fill:"#333840"},(0,e.createElement)("path",{d:"m11.383 23.271-1.161-.766 8.08-12.183.58.879s2.1 3.185 3.831 5.775c.4-.6.725-1.058.873-1.245a4.227 4.227 0 0 1 3.681-1.864 4.352 4.352 0 0 1 4.266 4.39 4.281 4.281 0 0 1-4.179 4.343 4.147 4.147 0 0 1-3.821-1.923c-.193-.277-.478-.694-.819-1.2a685.631 685.631 0 0 0-2.348 3.569l-1.167-.761c.094-.143 1.471-2.255 2.673-4.06-1.238-1.85-2.76-4.149-3.575-5.381Zm12.168-5.049c.476.709.876 1.3 1.125 1.653a2.747 2.747 0 0 0 2.594 1.33 2.93 2.93 0 0 0 2.872-2.96 2.961 2.961 0 0 0-2.908-2.99 2.88 2.88 0 0 0-2.52 1.289c-.172.222-.617.861-1.163 1.678Z"}),(0,e.createElement)("path",{d:"m1.114 23.215-1.163-.773L9.963 7.429l8.227 12.3-1.158.774L9.965 9.935Z"}))),edit:function({attributes:l,setAttributes:a,context:s}){const{postId:m}=s,p=(0,n.useRef)(),[u,E]=(0,n.useState)(!1);return(0,n.useEffect)((()=>()=>{l.hasOwnProperty("id")&&w("usages",{mediaflow_id:l.id,post_id:m,removed:!0,user:window.mediaflow.USER})}),[l,m]),(0,n.useEffect)((()=>{if(u){const{ACCESS_TOKEN:e,FORCE_ALT_TEXT:t,LOCALE:n}=window.mediaflow;new FileSelector(p.current,{accesstoken:e,allowJSVideo:!1,auth:"accesstoken",forceAltText:JSON.parse(t),limitFileType:"mp4,mov,mpg,ts,avi",locale:n,selectedFile:l.id,success:e=>{E(!1),a({id:e.id,content:e.embedCode}),w("usages",{mediaflow_id:e.id,post_id:m,user:window.mediaflow.USER})}})}}),[u,m]),(0,e.createElement)("div",{...(0,o.useBlockProps)()},(0,e.createElement)(o.BlockControls,null,(0,e.createElement)(t.ToolbarGroup,null,(0,e.createElement)(t.ToolbarButton,{className:"has-icon",onClick:()=>E(!0)},(0,e.createElement)(i,{icon:c})))),l.hasOwnProperty("content")?(0,e.createElement)("div",{style:{position:"relative"}},(0,e.createElement)("div",{style:{position:"absolute",width:"100%",height:"100%",zIndex:10}}),(0,e.createElement)(n.RawHTML,null,l.content)):(0,e.createElement)(t.Placeholder,{style:{minHeight:150},icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},(0,e.createElement)("g",{fill:"#333840"},(0,e.createElement)("path",{d:"m11.383 23.271-1.161-.766 8.08-12.183.58.879s2.1 3.185 3.831 5.775c.4-.6.725-1.058.873-1.245a4.227 4.227 0 0 1 3.681-1.864 4.352 4.352 0 0 1 4.266 4.39 4.281 4.281 0 0 1-4.179 4.343 4.147 4.147 0 0 1-3.821-1.923c-.193-.277-.478-.694-.819-1.2a685.631 685.631 0 0 0-2.348 3.569l-1.167-.761c.094-.143 1.471-2.255 2.673-4.06-1.238-1.85-2.76-4.149-3.575-5.381Zm12.168-5.049c.476.709.876 1.3 1.125 1.653a2.747 2.747 0 0 0 2.594 1.33 2.93 2.93 0 0 0 2.872-2.96 2.961 2.961 0 0 0-2.908-2.99 2.88 2.88 0 0 0-2.52 1.289c-.172.222-.617.861-1.163 1.678Z"}),(0,e.createElement)("path",{d:"m1.114 23.215-1.163-.773L9.963 7.429l8.227 12.3-1.158.774L9.965 9.935Z"}))),label:d.TN,instructions:"Open the file selector and select a video you want to display on your site."},(0,e.createElement)(t.Button,{variant:"primary",onClick:()=>E(!0)},(0,r.__)("Open file selector"))),u&&(0,e.createElement)(t.Modal,{title:d.TN,onRequestClose:()=>E(!1),isFullScreen:!0},(0,e.createElement)("div",{style:{position:"relative",width:"100%",height:"100%",minHeight:"600px"}},(0,e.createElement)("div",{className:"light",ref:p}))))},save:function({attributes:t}){return(0,e.createElement)(n.RawHTML,{...o.useBlockProps.save()},t.content)},usesContext:["postId"]})})();